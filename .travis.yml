dist: trusty
language: java
services:
- docker
jdk:
- oraclejdk8
before_cache:
- rm -f $HOME/.gradle/caches/modules-2/modules-2.lock
- rm -fr $HOME/.gradle/caches/*/plugin-resolution/
cache:
  directories:
  - "$HOME/.gradle/caches/"
  - "$HOME/.gradle/wrapper/"
before_deploy:
- export GRADLE_BUILD_DIR="build/libs"
- export TAG=$(git describe --abbrev=0 --tags)
- export MOD_TAG=${TAG#"v"}
- export RELEASE_PKG_FILE="${GRADLE_BUILD_DIR}/jswmm-${MOD_TAG}.jar"
- export FAT_PKG_FILE="${GRADLE_BUILD_DIR}/jswmm-${MOD_TAG}-all.jar"
- echo "building $FAT_PKG_FILE fat jar"
- gradle fatJar
- docker build -t "ftt01/jswmm:$MOD_TAG" .
- echo "$DOCKER_PASSWORD" | docker login -u "$DOCKER_USERNAME" --password-stdin
- docker push ftt01/jswmm:$MOD_TAG
- echo "deploying $RELEASE_PKG_FILE to GitHub releases"
- gradle -PprojVersion=$MOD_TAG -PnexusUsername="${SONATYPE_USERNAME}" -PnexusPassword="${SONATYPE_PASSWORD}"
  -PbintrayUsername="${BINTRAY_USERNAME}" -PbintrayApiKey="${BINTRAY_KEY}" -PbintrayPassphrase="${PASSPHRASE}"
  bintrayUpload
deploy:
  provider: releases
  api_key:
    secure: AZ3Ym1toWiI//pO4L9o2zria6op27mRxEwu/VRZv+AVT3dBpqhZM0yaeuA70ky0NSobIK4d+Utu3JkyuflWt+Kz4oNn7U06SIxfuz/wHdqy0zwtLqAIWIdcMWGGVGuiivhXde1cQil+wL4Jbhd12PrrE5H6BIf3HYTL+9QFRL5lH3f9puUAsSpat6WHuQFgLkg9PPPAj5J3oYmS5+cn0CHa4QiT0sYvGU2L+LuXVfBz64elVQ+yG2+3ChWXL/1z+9ygUlnQ127G6WMFYjOt0Qt2QYXH26OzujOTp1o6RYdhOorRP65QyXc0JBvl5eZahHW13EJ7Au+IUCqUoVfrHrZTlQDWyCklyRr1thwcKCl0u8VUGhe8AeEiz359n+Tf57jxi0F/Yf3y2GSpUxzIKL5cwzzEde6xwk2Hwi5m7U1vijCcnBVwGU6cwZeel5ttxp76L8162Tf5s945h9Z7d+81KujPwnts/FlwcaFXomX8FvneTPwcGKuWc7BRgghZoyUYyzQuzmzFsK543HpB1ntwY0bbROD8HrhwRGuvlID4JCOFBJ5wyZndvbfuQMr4I7HPnmNN94C2wqg9xD8jDcAC5C+fsvJ5e4Ywyj84d86qgXBRPwm1CyttUdkUunkB6JUpMNK+TR9gaXPPPGMfzQE3kz2nd3wArWcn/uvHRtv8=
  file: "${RELEASE_PKG_FILE}"
  skip_cleanup: true
  on:
    tags: true
    all_branches: true
    repo: geoframecomponents/jswmm
env:
  global:
  - secure: UCod+azhFiWYQaK/YD7RM0APrlnMs59WUGF7GUCANlbH/DWTkYGIQYwJp5bmOb2c8tleyzmcjmFouYqP75edxCuEm+AgsGyp3JU9Cazpz6Stvdtb+0sGV6/Jktfeym7G6QofmPRV2nuJOOT/hL+MpYuBD5g4kPvoX6cCv9kY9yHKhQsSFheP+JkKJbpxypIQSC3dFJItT2mA6FpABFANaOcKjlC+cYGRyZDxh7ojaOjelX5VAk4LolZ7zpyrX1iF047d0M9/GekhnbB1N9tWkXyaR4FgcIG2aHgf2WPj0joSkpSTlc9DxN8DF7+LqiB9HF/sv4YNzMEJCsHzwGJkZgWhlBsRkE0fMTFYYaGqUXJL0A9TKmitvB6JwtHo8Gb8JhWgugszg6pZ+I2Ax7KMT0j8MrEVqaV40WVp+oGvagC31CRRMd3ZGP3GJxD1bN+C0eZGdz9AtN+J6hkYYK7FuSly2CLz1BvbKsPyjF8r8axfmM9LQeTvlLioqzu3JoAJv7MFxYmMDOvb109q3u6ANnIodtm3D3MyM0KhRrBAVdqZC3RWjtTJbfGtZXdHz4ydZE046ou0ES8E5S61kmR2L+Ui9YyhllMgFA13GlBoERxO3AdVtpGtZol3G2Qp6jt6iDiDe63LIQJctOfLET/QJjJPSTTYMVEKU7m2kqENUiQ=
  - secure: Vi6XwGktt4GOIRQOOMNgxlG0oZYY99J0iFEUz0R6XUoqeC1RVxr+0t3Zdtkf40bps4ODWAP/zlwMHbTBU9LbtomwSZN7HxAiWIxf3rAPcSfk9Y7l3NjKOXf6JO0KgDuuW5RmbQ1Ts4CoF0OwUf8vkTUaGMj1NpnOxML/ZKnnpLa3iIWY+r4/y3mefG5xkpBcJotrTt8LuMMQl2ssat0ssqsmdyfmhcnEOiLbvUEZDhv//rTAnyv57TaNRUwpgIpTGqVhqpQT052WqhgAIqOEZbYvx/67R7r7UPQe+8M+jud5lZ1LyV17Af2pVNdftP8ex+AhAb5oGJFeoxVlfvw9XSqHzhqkk779DSOuqM7mHeUTlOFM+4O9bLS7fsap35pIkZ2t51MbvfJRyzQ336U73N2tcLSnfTqMm+HMIsic8GG9chEWE787m1LsO3/dWxyC1V6Sogp5w2JDITUZ75y1MstOlxMawAMs57ol/+hjXkamuhVdcvoXhBo/cTw3iysMot1ah+/yMdBc5piXGVh2wMcdZwBoFEDMHZk3O0vsbw7FIXOSw5Jw3TWyoXmZzmUZwXU1pelsdwG07zVYAbyh0Cibi7mGfq1XILGlIrACf0+qeBU2HaYZWpGYxG5nrNXWRFaQ1Zk7fTxWfK38mdL2jpaQTdsKiVur/3iyKU6fAMU=
  - secure: LnDuQvJwuQ3ZLdjDfdehCKFJIX1U6JhpWk9coTfg2+cAxe5yKTVmODPSB5GCXVujT8W9/gyZtovq/WL61IMiK8kbAGZ0noqHM77dapP0cx0OM9wuzCAnchOIzmaU6c0ogj6PxX5pooWsDIscxg3KLpL6032Z9epVTfx8lbftpiqd+ztY5WZM9/pHaSueonbvZW0PNV9q+R1lYYE2YjLA+wYk06M8Wo/VkFuMb4KaTpFcVGj0hcTm98QVFhpjbmopdyKJaAQ5qJgiR1n+RY6TO/Ks2BKiwPmo3OHvkc9WgNp6l+dt9nmrOS5VUbXeo5sfrxfrHV/YtXRWpo1P13ppBA+caiIXb9TFWVE/iJkINONHBvmK+sY0eQbUnIqupaOomb0R3Ys5hyBWKU611O7try/34OFxuCnFN6jdkpoe8o4ZF4ayGWrNne1Di3mq2sRihVJgBvLGOJ6rctfTQXhvfxI91FCRKwsZNAoOVyhdIKyudgovTS2ROqYedcO4mCZH+K9QPWKZ2pDdIhllj/ONQlXNZ7i/744rlAFz49mOkeXmUNsL/d5Z6xN5CJtCguo1PCwZEm+TN2cnuN/iqPx+f4A1wR0X6D16kflCR+Y8gqcGZ0yDVG9qpuWh0Ll7frPWasWfTecQAlNMtFv3BXKX3/8e+aaFfPiLWuTNPQT5ldc=
  - secure: S7bdV+6x2sP0Y39y39KhhOkmTP5kGwzyYsFX2LpXx8Wh6A9bWNUGXuK9W55anyGKqmw9Qtuyp9S9fQC4Okw1sNmIOuJo5v9bI4LB69cH9lITpP/cMyTCP5CZeaGN6LHh1+uaL0E+y2bOAiwWDb5brw6kvyRxZsARaUBpdAPTHiwO/yqm7sTtwrQxOT/93eyJBfPnhYvePEhD4Jyn58o0vZmsfNuJ4PEBNtmkYUFG5BG2FSxFx6FxG9ERy+fjojAL3rtQzBF9n79WfHfdHswx6L6Yuwty1QO0Tk3bl6Fi+JyNVyIgLd/uD7PAfwt02FqbfkE4ZKkb149KSynbW+zEw5z+lZWR0GLJpqz1A902b5ML3HpDj/1tDJG5EiHIuKvuGQinK+TYWjgZlO2K0KOqfkZSeskAGBzQLZF+DjrpuuVsXaBtV1H5o7+7127Av7hmcaw6clJENnB6l0ekWrUsufZUwYRTotS1DsLMeGXpfPxqLZ7Y+2H1w/myCZfQR8FVhHjqZnx+m38du0BAGUWufXCtxV4nsN20KynrjVV3EriU9iGlqow8atGl2uB3+DgzbvxoZZDNct/yKEgswiLplMXZdX+6+8HIQcTVQV+TpUeNuWCPZzBhWYkMPc7bVWfSkBErHSq/32BDdDhuCzc8uw1iflsYQp4zEgf3eW7VJDQ=
  - secure: jGLdRDRqN0BUPiJj+axDLvizrsOlYJQFgl3cNqdlVwZsbdJ3UFvdvIsKC+7VB3MxJ/ydrcvt53029zev2x3kpB309fJOmGDbcOS6uW4PIDV41Qos3mItNOHlZzEy7jCE4OCdgvyJR56TRLk/RvhGKT18sM3DSDO6Gcdexkf4UZG7lK5uZ62n8ozYjjq/w2e+znLqae7HuH9+qX9aVuzAJafYjeHqvOUQDh4WekvSnLavK+uLCwQoHrVpjDoGhkbJlpu8tfvWw2PgetxXzUGEs2P3JcBwfHmSIVIXEoWOQdej4NKZhdV0eQWJp7DO3ohR1rTtUq8Pex2TBnzzf/BMbxWd1OYpwTd6zhamiHK8hyzDpJtzjBtho2nPTdsvuNisuFrV6ovdxji0oL3P01cTNP12IED6cKAbiSEsnt39i/T+QdhWgYi8f+abMH2GjuJVR+CXoeu6tWIfzPRIE2noX8iWI1VnpaOfdmZIdrL6bb3XxG1MHm74Njkf7VI26Eu4WccvXLPTkK4dq6sTTfG9uiFhsftnHqrPGRBv/pj6Pq2/v0oZJ7yRTIgnmpWZaCJ+BgE2aQWr+E8L5Pq6LfruU+aKnE+j/gmyPUkwxS3t2JrH2sWiQnJ4vXKPwdr86K1jiB9QsfDcqI4kmNv7lHWMDYbmqwOUbXcQ80hq8xBFUZY=
  - secure: i6a171mWN+0aXpimiEEAUv1Tu8ZGfGf1yvocFIZ3BtDU9pHahB/NOmRJBLR7LlXnZH4lNaXjhz3pg3MiUTw9Az/kJbMuU5yYASmAjU/dARCVVSmnGYsnh6JlqNo9ALOt3Tb44nuYAuXTmqx1R7GlKjkNkzlhGvn0U995oiziQxSmuzbx4DNdRuu/zfKt5+kWbCm8Z3pQvws3Nue0d1JqL3Br3BNW0wMImWSGT2zIPpkADG9ejmbCazjLyyCgvDRKvexpHMs3I2PoIoqcgpS1mo+wVPVV5CDq4bT9nFlZw8cyehi0budtFskRqXrCiqS1yYxRkkkvJq4hFzp1yO4GOTgpjpZY9k3sH16iI+y+6Pbv4YyL4c3wn7lOPD5QDXoH1dEtwfXK948HqlFQ7M1SE7Zqw/6+VETmY1K28ke58wGbmdTyTTK0E7Ng0VFE1VCFBXmK2vEV42ZJkR/8h/IYBzfvlyBtb2AgGR4Nsv1csW2qT4WamiNp0PU8gTRA1DyiH6RwUa37GkWLf/Mg+Fjlcq55QckrrSUVXtNO9zsedCqFL3a+YGIwaK0BPOZJ5G+9AvIF5e7r4cKvJG3c2ec0H6UhwBpQhz8vy56rjbCu7HCqNe6TUVToCPf10xcWP9itimZ3OcKrW6UOf7lpetdUtPDrSpxF/dBoSnA/Qep4TFQ=
  - secure: Ecd8REZe6kRUPWoCmcSXkQJ9pAOA73oY/EFhAsYlHXFYtvcp6kAh4tESn0s2myX8fb6odJScfdavXyTUgYS7n05IyswJkqdf4ldfHtfIt5scpPWo7MPFvcOPy2fIZHl6KfGXHBco3OE33NhXxlSlnUVzG7GzsEgBuHzgQUje+Kyj9rapJmXcUSGl2K2z+P4pIp55Bwx+XFOstxT6NbVq0QfXcgfyZW9q8S+Wdwdo1CNIWVUHpbzQdzrPKw5W0uLVmAN/nDMd4zkw3OhcxEk9KT2zWs/1ndELsdCnT8b9n2KZuMjWUv5PghtDi7fBqbRboecrYliTeXGNj8eFVwti09vgEnktJxe+xeNNuXorhPPLBBEeN67bBMIQmiLO+lph6PDxdB6UTEiV0L2ymFSAe9eTrJjstUKXWXRRJwnSDzbxTIFZjKu2MTWlbVHGpZEyWaf5vtBibYQ3j6P9fLcEJgUWRbV7s5n2Bca4rmCQkL6+N+SwDvoI2qbePn1+S6tTw3WK3/WmOzgPWe3DEy78QVcyUwORVZ5xrbttzIkYyshnvuuUIC4AWZpZ+NB56kRQtUviQuoIGEFWKXanuLsuJb0kl9c1k7kiiAFHiccQBGXQmL+uykrQzdggHJDH9M7oHrxB810MBxvA0TePl0oePT70YdWreKFHxuO4iJx/xfk=
